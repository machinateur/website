{# component: reader mode #}

{% block style %}
    <!-- component: reader mode -->
    <style>
        body .rm {
            transition: opacity 500ms linear;
        }
        body[data-app-reader-mode="true"] .rm {
            opacity: 0.0;
        }
        body[data-app-reader-mode="false"] .rm {
            opacity: 1.0;
        }
    </style>
{% endblock %}

{% block data %}
    data-app-reader-mode="{{ value|default(false) ? 'true' : 'false' }}"
{% endblock %}

{% block html %}
    <!-- component: reader mode -->
    <div class="d-flex" data-app-component="reader-mode">
        <input type="checkbox" class="btn-check" id="btnCheck{{ id }}" autocomplete="off">
        <label class="btn btn-outline-primary" for="btnCheck{{ id }}">
            {{ source('svg/book.svg') }}
        </label>
    </div>
{% endblock %}

{% block script %}
    <!-- component: reader mode -->
    <script type="text/javascript">
        (function () {
            'use strict';

            var list = document.querySelectorAll('[data-app-component="reader-mode"]');

            Array.prototype.slice.call(list)
                .forEach(
                    /**
                     * @param component HTMLDivElement
                     */
                    function (component) {
                        /** @type HTMLInputElement */
                        var checkbox = component.querySelector('input[type="checkbox"]');

                        checkbox.addEventListener('change', function (event) {
                            document.body.dataset.appReaderMode = !!checkbox.checked ? 'true' : 'false';
                        }, false);
                    }
                );
        })();
    </script>
{% endblock %}
